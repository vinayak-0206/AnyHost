# Default values for AnyHost
# This is a YAML-formatted file.

replicaCount: 1

image:
  repository: anyhost/gotunnel
  pullPolicy: IfNotPresent
  tag: ""  # Defaults to appVersion

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# AnyHost Configuration
config:
  # Base domain for tunnel subdomains (e.g., tunnel.example.com)
  domain: "tunnel.example.com"

  # Log level: debug, info, warn, error
  logLevel: "info"

  # Authentication mode: token, jwt, none
  authMode: "token"

  # List of reserved subdomains that cannot be claimed
  reservedSubdomains:
    - www
    - api
    - admin
    - mail
    - app

  # Resource limits
  limits:
    maxConnectionsPerUser: 5
    maxTunnelsPerConnection: 10
    maxRequestsPerMinute: 1000
    maxRequestBodySize: 52428800  # 50MB

  # CORS allowed origins (leave empty to auto-generate from domain)
  corsAllowedOrigins: []

# Secret configuration (for tokens, etc.)
secrets:
  # Create a Kubernetes secret with auth tokens
  # Format: token1:user1,token2:user2
  authTokens: ""

  # Or reference an existing secret
  existingSecret: ""
  existingSecretKey: "tokens"

# Persistence for SQLite database
persistence:
  enabled: true
  storageClass: ""
  accessModes:
    - ReadWriteOnce
  size: 1Gi
  annotations: {}

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext:
  fsGroup: 1000

securityContext:
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 1000

service:
  type: ClusterIP
  port: 8080

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: tunnel.example.com
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: tunnel-tls
  #    hosts:
  #      - tunnel.example.com

  # Wildcard ingress for subdomains (requires wildcard DNS)
  wildcard:
    enabled: false
    host: "*.tunnel.example.com"
    tls: []
    #  - secretName: tunnel-wildcard-tls
    #    hosts:
    #      - "*.tunnel.example.com"

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Health check configuration
healthCheck:
  enabled: true
  path: /health
  initialDelaySeconds: 5
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
